function HoneyProducts() {
	HoneyHope.apply(this, [ $("#btn_crepro"), $("#btn_updpro"), $("#btn_delpro"), $('<tbody></tbody>').attr('id', 'tbody_prod'), $("#modal-prod") ]);
	var Clave = $("#clave_prod"), Nombre = $("#nom_prod"), Capacidad = $("#cap_prod"), Presentacion = $("#pres_prod"), Tipo = $("#tip_prod"), Resumen = $("#res_prod"), Detalles = $("#des_prod"), Precio = $("#pre_prod"), Cantidad = $("#cantidad_prod"), IVA = $("#iva_prod"), token = $("#token_prod").val(), that = this; 

	that.btn1.click(function(){
		that.Route = "/Productos";
		that.Types = "POST";
		that.Datos = { Vch_IdPro : Clave.val(), Vch_NomProd : Nombre.val(), Sml_IdCap : Capacidad.val(), Sml_IdPres : Presentacion.val(), Sml_Tipoo : Tipo.val(), Vch_Res : Resumen.val(), Vch_Des : Detalles.val(), Flt_PreUni : Precio.val(), Int_Cant : Cantidad.val(), IVAA : IVA.val(), Vch_Tipo : 'Insertar' };
		that.Ajax(token);
	});

	that.btn2.click(function(){
		that.Route = "/Productos/"+Clave.val()+"";
		that.Types = "PUT";
		that.Datos = { Vch_IdPro : Clave.val(), Vch_NomProd : Nombre.val(), Sml_IdCap : Capacidad.val(), Sml_IdPres : Presentacion.val(), Sml_Tipoo : Tipo.val(), Vch_Res : Resumen.val(), Vch_Des : Detalles.val(), Flt_PreUni : Precio.val(), Int_Cant : Cantidad.val(), IVAA : IVA.val(), Vch_Tipo : 'Actualizar' };
		that.Ajax(token);	
	});

	that.btn3.click(function(){
		that.Route = "/Productos/"+Clave.val()+"";
		that.Types = "DELETE";
		that.Datos = { Vch_IdPro : Clave.val(), Vch_NomProd : Nombre.val(), Sml_IdCap : Capacidad.val(), Sml_IdPres : Presentacion.val(), Sml_Tipoo : Tipo.val(), Vch_Res : Resumen.val(), Vch_Des : Detalles.val(), Flt_PreUni : Precio.val(), Int_Cant : Cantidad.val(), IVAA : IVA.val(), Vch_Tipo : 'Eliminar' };
		that.Ajax(token);		
	});

	$("#btn_newprod").click(function(){ that.Modal(this, 1); });

	$(document).on('click', '#btn_editprod', function(e){ 
		e.preventDefault();
		that.Route = "/Productos/"+this.value+"/edit";
		that.Types = "GET";
		that.Modal(this, 2);
	});

	$(document).on('click', '#btn_deleteprod', function(e){
		e.preventDefault();
		that.Route = "/Productos/"+this.value+"/edit";
		that.Types = "GET";
		that.Modal(this, 3);		
	});

	$(document).on('click', '.pagination a', function(e){
		e.preventDefault();
		that.page = $(this).attr('href').split('page=')[1];
		that.Route = "/Productos";
		that.Pagination();
	});

	that.CargaTabla = function(value){
		that.Route = "/Productos";
		that.tabla.empty();
		$.get(that.Route, function(response){
			if(value == 1){ that.CargaDatosTabla(); }else{ that.CargaDatosTabla(1, response); }
		});
	}

	that.CargaDatosTabla = function(pagination = 0, data = null){
		that.Route = "/tableproductos";
		that.page = (pagination == 0)? that.page = 1 : that.page = pagination;
		that.tabla.empty();
		$.ajax({
			url: that.Route,
			data: { page: that.page },
			type: 'GET',
			dataType: 'json',
			beforeSend: function(){
				$('.preloader').show();
			},
			success : function(response){
				$(response.data).each(function(){
					that.tabla.append("<tr><td>"+this.Vch_IdProducto+"</td>"+
						"<td>"+this.Vch_NombreProducto+"</td><td>"+this.Vch_Capacidad+"</td><td>"+this.Vch_Presentacion+"</td><td>"+this.Vch_TipoProducto+"</td>"+
						"<td>"+this.Vch_Resumen+"</td><td>"+this.Vch_Descripcion+"</td><td>"+this.Flt_PrecioUnitario+"</td>"+
						"<td>"+this.Int_Cantidad+"</td><td>"+this.IVA+"</td>"+
						"<td><button class='btn btn-success' id='btn_editprod' value="+this.Vch_IdProducto+">Editar</button></td>"+
						"<td><button class='btn btn-danger' id='btn_deleteprod' value="+this.Vch_IdProducto+">Eliminar</button></td></tr>")	
				});
				$("#tableprod").append(that.tabla);
				if(data != null){ $("#render").html(data); }
				$('.preloader').hide();
			}
		});
	}

	that.CargaCombo = function(){
		$.ajax({
			url: '/combosproductos',
			type: 'GET',
			dataType: 'json',
			success : function(response){
				$(response).each(function(key, value){
					if(value.Sml_IdCapacidad){
						var option = $(document.createElement('option'));
						option.val(this.Sml_IdCapacidad);
						option.text(this.Vch_Capacidad);
						$(Capacidad).append(option);	
					}else{
						if(value.Sml_IdPresentacion){
							var option = $(document.createElement('option'));
							option.val(this.Sml_IdPresentacion);
							option.text(this.Vch_Presentacion);
							$(Presentacion).append(option);	
						}else{
							if(value.Sml_TipoProducto){
								var option = $(document.createElement('option'));
								option.val(this.Sml_TipoProducto);
								option.text(this.Vch_TipoProducto);
								$(Tipo).append(option);
							}else{
								var option = $(document.createElement('option'));
								option.val(this.id_iva);
								option.text(this.vch_iva);
								$(IVA).append(option);	
							}
						}
					}
				});
			},
			error : function(){
				alert(that.getMsj_Error());
			}
		});	
	}

	that.LlenaModal = function(response){
		$(response).each(function(){
			Clave.val(this.Vch_IdProducto); Nombre.val(this.Vch_NombreProducto);
			$('#cap_prod option:contains('+this.Vch_Capacidad+')').attr('selected', 'selected');
			$('#pres_prod option:contains('+this.Vch_Presentacion+')').attr('selected', 'selected');	
			$('#tip_prod option:contains('+this.Vch_TipoProducto+')').attr('selected', 'selected');
			Resumen.val(this.Vch_Resumen); Detalles.val(this.Vch_Descripcion); Precio.val(this.Flt_PrecioUnitario);
			Cantidad.val(this.Int_Cantidad); $('#iva_prod option:contains('+this.IVA+')').attr('selected', 'selected');
		});
		that.Modall.modal('show');
	}
}

HoneyProducts.prototype = HoneyHope;

var hp = new HoneyProducts();

$(document).ready(function(){
	hp.CargaTabla(0);
	hp.CargaCombo();
});