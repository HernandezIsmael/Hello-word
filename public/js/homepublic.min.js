var lista = $('.nav li');

document.addEventListener("DOMContentLoaded", CargaImagenes, false);

//window.onbeforeunload = Saber;

$("#fb").click(function(){
	url = "https://www.facebook.com/";
	return social();
});

$("#tw").click(function(){
	url = "https://www.twitter.com/";
	return social();		
});

$("#insta").click(function(){
	url = "https://www.instagram.com/";
	return social();	
});

$('.nav li').click(function(event){
    $('.active').removeClass('active');
    var index = $(this).index();
	switch(index){
	    case 0:
	       	CargaSeccion('../', index);
	       	break;
	    case 2:
	       	CargaSeccion('/Nosotros', index);
	       	break;
	    case 3:
	       	CargaSeccion('/Visitanos', index);
	       	break;
	}
});

$('#idmodal').click(function(){
	$('#modal').modal('show');
});

$(window).scroll(function(){
   	if(matchMedia('only screen and (max-width:600px)').matches){
   		if($(this).scrollTop() > 100) { menu(true); } else { menu(false); }	
   	}else{
   		if(matchMedia('screen and (min-width: 768px)').matches){
   			if($(this).scrollTop() > 400) { menu(true); } else { menu(false); }	
   		}	
   	}
});

function CargaImagenes(){
	var ArrayImg = new Array();
	var nombres = '#logof';
	for(var i = 0; i < 5; i ++){
		ArrayImg[i] = nombres+i;
	}

	$.ajax({
		success:function(){
			var url = urls();
			for(var i = 0; i < 5; i ++){
				if(i == 0){
					$(ArrayImg[i]).addClass('intro_img');
				}else{
					$(ArrayImg[i]).attr('src', url[i - 1 ]);
				}
			}
		}
	});
}

function urls(){
	var Urls = new Array();
	Urls.push('images/logo.png', 'fonts/Facebook.svg', 'fonts/Twitter.svg', 'fonts/Instagram Old.svg');
	return Urls;
}

function social(){
	window.open(url, '_blank');
	return false;
}

function menu(flag) {
	if(flag){
		return $('.cambiante').addClass('menu_blanco');	
	}else{
		return $('.cambiante').removeClass('menu_blanco');	
	}
}

function CargaSeccion(urlp, index){
	$.ajax({
		url: urlp,
		type: 'GET',
		dataType: 'json',
		success : function(data){
			$("#main_index").empty();
			$("#main_index").append($(data));
			history.pushState(null, "", '..'+urlp);
			if(index != null){ $(lista[index]).addClass('active'); }else { alert("es null"); }
		},
		error : function(data){
			var errors = data.responseJSON;
            if (errors) {
                $.each(errors, function (i) {
                    console.log(errors[i]);
                });
            }
		}
	});
}

function Saber(){
	$.each(lista, function(index, value){
		if($(lista[index]).prop('class') == 'active'){
			Seccion(index);	
		}
	});
}

